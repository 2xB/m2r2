
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>M2R2 &#8212; M2R2 0.3.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example" href="example.html" />
  <!-- font -->
  <link href='https://fonts.googleapis.com/css?family=Lato:400,400italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
  <!-- Style -->
  
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />


  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="m2r2">
<h1>M2R2<a class="headerlink" href="#m2r2" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/m2r2"><img alt="PyPI" src="https://img.shields.io/pypi/v/m2r2.svg" /></a>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/m2r2"><img alt="PyPI version" src="https://img.shields.io/pypi/pyversions/m2r2.svg" /></a>
<a class="reference external image-reference" href="https://crossnox.github.io/m2r2"><img alt="Documentation" src="https://img.shields.io/badge/docs-latest-brightgreen.svg" /></a>
<a class="reference external image-reference" href="https://github.com/CrossNox/m2r2/workflows/Python%20package/badge.svg"><img alt="Python package" src="https://github.com/CrossNox/m2r2/workflows/Python%20package/badge.svg" /></a>
<hr class="docutils" />
<p>M2R2 converts a markdown file including reStructuredText (rst) markups to a valid
rst format.</p>
<div class="section" id="m2r-the-original">
<h2>M2R: the original<a class="headerlink" href="#m2r-the-original" title="Permalink to this headline">¶</a></h2>
<p>M2R2 is a fork of <a class="reference external" href="https://github.com/miyakogi/m2r">m2r</a> which hasn’t been updated for a long time
and there’s been no response from the author about a PR fixing a serious issue that broke several
pipelines using <code class="docutils literal notranslate"><span class="pre">sphinx3</span></code>. Every <code class="docutils literal notranslate"><span class="pre">m2r</span></code> config should work out of the box. I’ve changed some of the tooling for what I’m mostly using now. Below goes
the original readme, changing only what’s needed to work with <code class="docutils literal notranslate"><span class="pre">m2r2</span></code>.</p>
</div>
<div class="section" id="why-another-converter">
<h2>Why another converter?<a class="headerlink" href="#why-another-converter" title="Permalink to this headline">¶</a></h2>
<p>I wanted to write sphinx document in markdown, since it’s widely used now and
easy to write code blocks and lists. However, converters using pandoc or
recommonmark do not support many rst markups and sphinx extensions. For
example, rst’s reference link like <code class="docutils literal notranslate"><span class="pre">see</span> <span class="pre">`ref`_</span></code> (this is very convenient in
long document in which same link appears multiple times) will be converted to
a code block in HTML like <code class="docutils literal notranslate"><span class="pre">see</span> <span class="pre">&lt;code&gt;ref&lt;/code&gt;_</span></code>, which is not expected.</p>
</div>
<div class="section" id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Basic markdown and some extensions (see below)</p>
<ul>
<li><p>inline/block-level raw html</p></li>
<li><p>fenced-code block</p></li>
<li><p>tables</p></li>
<li><p>footnotes (<code class="docutils literal notranslate"><span class="pre">[^1]</span></code>)</p></li>
</ul>
</li>
<li><p>Inline- and Block-level rst markups</p>
<ul>
<li><p>single- and multi-line directives (<code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">directive::</span></code>)</p></li>
<li><p>inline-roles (<code class="docutils literal notranslate"><span class="pre">:code:`print(1)`</span> <span class="pre">...</span></code>)</p></li>
<li><p>ref-link (<code class="docutils literal notranslate"><span class="pre">see</span> <span class="pre">`ref`_</span></code>)</p></li>
<li><p>footnotes (<code class="docutils literal notranslate"><span class="pre">[#fn]_</span></code>)</p></li>
<li><p>math extension inspired by <a class="reference external" href="https://recommonmark.readthedocs.io/en/latest/index.html">recommonmark</a></p></li>
</ul>
</li>
<li><p>Sphinx extension</p>
<ul>
<li><p>add markdown support for sphinx</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mdinclude</span></code> directive to include markdown from md or rst files</p></li>
<li><p>option to parse relative links into ref and doc directives (<code class="docutils literal notranslate"><span class="pre">m2r_parse_relative_links</span></code>)</p></li>
<li><p>option to render <code class="docutils literal notranslate"><span class="pre">mermaid</span></code> blocks as graphs with <cite>sphinxcontrib.mermaid &lt;https://sphinxcontrib-mermaid-demo.readthedocs.io/en/latest/index.html</cite>&gt;`_ (<code class="docutils literal notranslate"><span class="pre">m2r_use_mermaid</span></code>, default: auto)</p>
<ul>
<li><p>auto means that m2r2 will check if <code class="docutils literal notranslate"><span class="pre">sphinxcontrib.mermaid</span></code> has been added to the extensions list</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Pure python implementation</p>
<ul>
<li><p>pandoc is not required</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Python 2.7 or Python 3.4+ is required.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">m2r2</span>
</pre></div>
</div>
<p>Or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">m2r2</span>
</pre></div>
</div>
<p>or using <code class="docutils literal notranslate"><span class="pre">conda</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">m2r2</span>
</pre></div>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="command-line">
<h3>Command Line<a class="headerlink" href="#command-line" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">m2r2</span></code> command converts markdown file to rst format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m2r2</span> <span class="n">your_document</span><span class="o">.</span><span class="n">md</span> <span class="p">[</span><span class="n">your_document2</span><span class="o">.</span><span class="n">md</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>Then you will find <code class="docutils literal notranslate"><span class="pre">your_document.rst</span></code> in the same directory.</p>
</div>
<div class="section" id="programmatic-use">
<h3>Programmatic Use<a class="headerlink" href="#programmatic-use" title="Permalink to this headline">¶</a></h3>
<p>Import <code class="docutils literal notranslate"><span class="pre">m2r2.convert</span></code> function and call it with markdown text.
Then it will return converted text.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">m2r2</span> <span class="kn">import</span> <span class="n">convert</span>
<span class="n">rst</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="s1">&#39;# Title</span><span class="se">\n\n</span><span class="s1">Sentence.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rst</span><span class="p">)</span>
<span class="c1"># Title</span>
<span class="c1"># =====</span>
<span class="c1">#</span>
<span class="c1"># Sentence.</span>
</pre></div>
</div>
<p>Or, use <code class="docutils literal notranslate"><span class="pre">parse_from_file</span></code> function to load markdown file and obtain converted
text.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">m2r2</span> <span class="kn">import</span> <span class="n">parse_from_file</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">parse_from_file</span><span class="p">(</span><span class="s1">&#39;markdown_file.md&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is an example of setup.py to write README in markdown, and publish it to
PyPI as rst format.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">readme_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s1">&#39;README.md&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">m2r2</span> <span class="kn">import</span> <span class="n">parse_from_file</span>
    <span class="n">readme</span> <span class="o">=</span> <span class="n">parse_from_file</span><span class="p">(</span><span class="n">readme_file</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="c1"># m2r2 may not be installed in user environment</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">readme_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">readme</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">setup</span><span class="p">(</span>
    <span class="o">...</span><span class="p">,</span>
    <span class="n">long_description</span><span class="o">=</span><span class="n">readme</span><span class="p">,</span>
    <span class="o">...</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="sphinx-integration">
<h3>Sphinx Integration<a class="headerlink" href="#sphinx-integration" title="Permalink to this headline">¶</a></h3>
<p>In your conf.py, add the following lines.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">...</span><span class="p">,</span>
    <span class="s1">&#39;m2r2&#39;</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># source_suffix = &#39;.rst&#39;</span>
<span class="n">source_suffix</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.rst&#39;</span><span class="p">,</span> <span class="s1">&#39;.md&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Write index.md and run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span></code>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">m2r2</span></code> extension is enabled on sphinx and <code class="docutils literal notranslate"><span class="pre">.md</span></code> file is loaded, m2r2
converts to rst and pass to sphinx, not making new <code class="docutils literal notranslate"><span class="pre">.rst</span></code> file.</p>
<div class="section" id="mdinclude-directive">
<h4>mdinclude directive<a class="headerlink" href="#mdinclude-directive" title="Permalink to this headline">¶</a></h4>
<p>Like <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">include::</span> <span class="pre">file</span></code> directive, <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">mdinclude::</span> <span class="pre">file</span></code> directive inserts
markdown file at the line.</p>
<p>Note: do not use <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">include::</span> <span class="pre">file</span></code> directive to include markdown file even if
in the markdown file, please use <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">mdinclude::</span> <span class="pre">file</span></code> instead.</p>
</div>
</div>
</div>
<div class="section" id="restrictions">
<h2>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>In the rst’s directives, markdown is not available. Please write in rst.</p></li>
<li><p>Column alignment of tables is not supported. (rst does not support this feature)</p></li>
<li><p>Heading with overline-and-underline is not supported.</p>
<ul>
<li><p>Heading with underline is OK</p></li>
</ul>
</li>
<li><p>Rst heading marks are currently hard-coded and unchangeable.</p>
<ul>
<li><p>H1: <code class="docutils literal notranslate"><span class="pre">=</span></code>, H2: <code class="docutils literal notranslate"><span class="pre">-</span></code>, H3: <code class="docutils literal notranslate"><span class="pre">^</span></code>, H4: <code class="docutils literal notranslate"><span class="pre">~</span></code>, H5: <code class="docutils literal notranslate"><span class="pre">&quot;</span></code>, H6: <code class="docutils literal notranslate"><span class="pre">#</span></code></p></li>
</ul>
</li>
</ul>
<p>If you find any bug or unexpected behaviour, please report it to
<a class="reference external" href="https://github.com/crossnox/m2r2/issues">Issues</a>.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference external" href="https://crossnox.github.io/m2r2/example.html">example document</a> and <a class="reference external" href="https://github.com/crossnox/m2r2/blob/master/docs/example.md">its
source code</a>.</p>
<p><em>Note from the original author:</em> I’m using m2r for writing user guide of <a class="reference external" href="https://github.com/miyakogi/wdom">WDOM</a>.
So you can see it as another example. Its <a class="reference external" href="http://wdom-py.readthedocs.io/en/latest/guide/index.html">HTML is
here</a>, and <a class="reference external" href="https://github.com/miyakogi/wdom/tree/dev/docs/guide">its
source code is here</a>.</p>
<div class="section" id="demo-editor">
<h3>Demo editor<a class="headerlink" href="#demo-editor" title="Permalink to this headline">¶</a></h3>
<p><em>Note:</em> This hasn’t received any updates.</p>
<p>Demo editor of m2r is available.
If you are interested in m2r, please try it.</p>
<p><a class="reference external" href="https://github.com/miyakogi/m2rdemo">https://github.com/miyakogi/m2rdemo</a></p>
</div>
</div>
<div class="section" id="dev-install">
<h2>Dev install<a class="headerlink" href="#dev-install" title="Permalink to this headline">¶</a></h2>
<p>Please install the <code class="docutils literal notranslate"><span class="pre">dev</span></code> dependencies and <code class="docutils literal notranslate"><span class="pre">pre-commit</span></code> hooks with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -r requirements-dev.txt
pre-commit install
</pre></div>
</div>
</div>
<div class="section" id="acknowledgement">
<h2>Acknowledgement<a class="headerlink" href="#acknowledgement" title="Permalink to this headline">¶</a></h2>
<p>m2r is written as an extension of
<a class="reference external" href="http://mistune.readthedocs.io/en/latest/">mistune</a>, which is highly extensible
pure-python markdown parser.
Without the mistune, I couldn’t write this. Thank you!</p>
</div>
<div class="section" id="licence">
<h2>Licence<a class="headerlink" href="#licence" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/crossnox/m2r2/blob/master/LICENSE">MIT</a></p>
</div>
<div class="section" id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="example.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change Log</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">M2R2</a></h1>



<p class="blurb">Markdown mixed to reST</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=CrossNox&repo=m2r2&type=mark&count=False&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="example.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change Log</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
      <li>Next: <a href="example.html" title="next chapter">Example</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Hiroyuki Takagi.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.md.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/CrossNox/m2r2" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>